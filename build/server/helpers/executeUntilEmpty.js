// Generated by CoffeeScript 1.10.0
var executeUntilEmpty, sudo;

sudo = require('./sudo');

module.exports = executeUntilEmpty = function(commands, config, callback) {
  var child, command;
  command = commands.shift();
  child = sudo(config.user, config.cwd, command);
  return child.on('close', function(code) {
    if (code !== 0) {
      return callback(new Error(command + " failed with code " + code));
    } else if (commands.length > 0) {
      return executeUntilEmpty(commands, config, callback);
    } else {
      return callback();
    }
  });
};
